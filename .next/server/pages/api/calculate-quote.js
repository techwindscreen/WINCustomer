"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/calculate-quote";
exports.ids = ["pages/api/calculate-quote"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcalculate-quote&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcalculate-quote.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcalculate-quote&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcalculate-quote.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_calculate_quote_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/calculate-quote.ts */ \"(api)/./pages/api/calculate-quote.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_calculate_quote_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_calculate_quote_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/calculate-quote\",\n        pathname: \"/api/calculate-quote\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_calculate_quote_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNhbGN1bGF0ZS1xdW90ZSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGY2FsY3VsYXRlLXF1b3RlLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQzJEO0FBQzNEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywwREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsMERBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvY2FsY3VsYXRlLXF1b3RlLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jYWxjdWxhdGUtcXVvdGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jYWxjdWxhdGUtcXVvdGVcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcalculate-quote&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcalculate-quote.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/supabaseClient.ts":
/*!*******************************!*\
  !*** ./lib/supabaseClient.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\nif (false) {}\nif (false) {}\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://julpwjxzrlkbxdbphrdy.supabase.co\" || 0, \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp1bHB3anh6cmxrYnhkYnBocmR5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc0MTQ4NDUsImV4cCI6MjA1Mjk5MDg0NX0.rynZAq6bjPlpfyTaxHYcs8FdVdTo_gy95lazi2Kt5RY\" || 0);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc3VwYWJhc2VDbGllbnQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW9EO0FBRXBELElBQUksS0FBcUMsRUFBRSxFQUUxQztBQUVELElBQUksS0FBMEMsRUFBRSxFQUUvQztBQUVNLE1BQU1PLFdBQVdQLG1FQUFZQSxDQUNsQ0MsMENBQW9DLElBQUksQ0FBRSxFQUMxQ0Esa05BQXlDLElBQUksQ0FBRSxFQUNoRCIsInNvdXJjZXMiOlsiL1VzZXJzL211aGFtbWFkYWxpL0Rlc2t0b3AvV2luZHNjcmVlbkNvbXBhcmUvd2luZHNoaWVsZF9jb21wYXJlL1dpbmRDb21wYXJlL2xpYi9zdXBhYmFzZUNsaWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXG5cbmlmICghcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMKSB7XG4gIGNvbnNvbGUuZXJyb3IoJ01pc3NpbmcgTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMJylcbn1cblxuaWYgKCFwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSkge1xuICBjb25zb2xlLmVycm9yKCdNaXNzaW5nIE5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZJylcbn1cblxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxuICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgfHwgJycsXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8ICcnXG4pICJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiY29uc29sZSIsImVycm9yIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJzdXBhYmFzZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/supabaseClient.ts\n");

/***/ }),

/***/ "(api)/./pages/api/calculate-quote.ts":
/*!**************************************!*\
  !*** ./pages/api/calculate-quote.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/supabaseClient */ \"(api)/./lib/supabaseClient.ts\");\n\n// Fetch vehicle valuation data\nasync function fetchVehicleValuation(registration) {\n    try {\n        const apiKey = process.env.UK_VEHICLE_DATA_API_KEY;\n        if (!apiKey) {\n            console.error('UK_VEHICLE_DATA_API_KEY environment variable is not set');\n            return null;\n        }\n        console.log(`Fetching valuation data for registration: ${registration}`);\n        const response = await fetch(`https://uk1.ukvehicledata.co.uk/api/datapackage/ValuationData?v=2&api_nullitems=1&auth_apikey=${apiKey}&key_VRM=${registration}`, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n        const data = await response.json();\n        console.log('Full Valuation API response:', JSON.stringify(data, null, 2));\n        if (data.Response?.StatusCode === \"Success\") {\n            console.log('API call successful, checking for valuation data...');\n            // Check the correct path for valuation data\n            const dataItems = data.Response.DataItems;\n            if (dataItems && dataItems.ValuationList) {\n                console.log('ValuationList found:', JSON.stringify(dataItems.ValuationList, null, 2));\n                const otrValue = dataItems.ValuationList.OTR;\n                if (otrValue) {\n                    console.log(`OTR value found: £${otrValue}`);\n                    return parseFloat(otrValue);\n                } else {\n                    console.log('OTR value not found in ValuationList');\n                    console.log('Available fields in ValuationList:', Object.keys(dataItems.ValuationList));\n                }\n            } else {\n                console.log('ValuationList not found in DataItems');\n                console.log('Available DataItems fields:', dataItems ? Object.keys(dataItems) : 'None');\n            }\n        } else {\n            console.log(`API call failed with status: ${data.Response?.StatusCode}`);\n            console.log(`Status message: ${data.Response?.StatusMessage}`);\n        }\n        return null;\n    } catch (error) {\n        console.error('Error fetching vehicle valuation:', error);\n        return null;\n    }\n}\n// Calculate materials cost based on OTR price and window type\n// Example: For OTR price £20,000 with Windscreen + Front Driver Door + Rear Window + Rear Driver Door + Rear Passenger Door + Front Passenger Door:\n// - Windscreen: 1.2% × £20,000 = £240\n// - Front Driver Door: 0.25% × £20,000 = £50  \n// - Rear Window: 0.5% × £20,000 = £100\n// - Rear Driver Door: 0.25% × £20,000 = £50\n// - Rear Passenger Door: 0.25% × £20,000 = £50\n// - Front Passenger Door: 0.25% × £20,000 = £50\n// Total: £540 (+ £30 per window if tinted)\nfunction calculateMaterialsCost(otrPrice, selectedWindows, glassColor) {\n    if (!otrPrice || isNaN(otrPrice)) {\n        console.log('OTR price not available, using minimum materials cost of £70');\n        return 70;\n    }\n    // Window type percentage multipliers based on OTR price\n    const windowOTRPercentages = {\n        'jqvmap1_ws': 0.012,\n        'jqvmap1_rw': 0.005,\n        'jqvmap1_df': 0.0025,\n        'jqvmap1_dg': 0.0025,\n        'jqvmap1_dr': 0.0025,\n        'jqvmap1_dd': 0.0025,\n        'jqvmap1_vp': 0.005,\n        'jqvmap1_vf': 0.005,\n        'jqvmap1_vr': 0.005,\n        'jqvmap1_vg': 0.005,\n        'jqvmap1_qr': 0.004,\n        'jqvmap1_qg': 0.004 // Rear Driver Quarter - 0.4% (quarter)\n    };\n    let totalMaterialsCost = 0;\n    if (selectedWindows && Array.isArray(selectedWindows)) {\n        for (const windowId of selectedWindows){\n            const percentage = windowOTRPercentages[windowId];\n            if (percentage) {\n                const windowCost = otrPrice * percentage;\n                totalMaterialsCost += windowCost;\n                // Check for privacy/tinting and add £30 if applicable\n                let privacyCost = 0;\n                if (glassColor && glassColor[windowId] === 'Tinted Black') {\n                    privacyCost = 30;\n                    totalMaterialsCost += privacyCost;\n                }\n                const privacyNote = privacyCost > 0 ? ` + £${privacyCost} (privacy)` : '';\n                console.log(`Window ${windowId}: ${percentage * 100}% of £${otrPrice} = £${windowCost.toFixed(2)}${privacyNote} = £${(windowCost + privacyCost).toFixed(2)}`);\n            } else {\n                console.log(`Unknown window type: ${windowId}, using default 0.25% of OTR`);\n                const windowCost = otrPrice * 0.0025; // Default 0.25%\n                totalMaterialsCost += windowCost;\n                // Check for privacy/tinting and add £30 if applicable\n                let privacyCost = 0;\n                if (glassColor && glassColor[windowId] === 'Tinted Black') {\n                    privacyCost = 30;\n                    totalMaterialsCost += privacyCost;\n                }\n                const privacyNote = privacyCost > 0 ? ` + £${privacyCost} (privacy)` : '';\n                console.log(`Window ${windowId} (unknown): 0.25% of £${otrPrice} = £${windowCost.toFixed(2)}${privacyNote} = £${(windowCost + privacyCost).toFixed(2)}`);\n            }\n        }\n    }\n    // Ensure minimum materials cost is £70\n    const finalCost = Math.max(totalMaterialsCost, 70);\n    console.log(`Total materials cost: £${totalMaterialsCost.toFixed(2)}, Final cost (min £70): £${finalCost.toFixed(2)}`);\n    return Math.round(finalCost * 100) / 100; // Round to 2 decimal places\n}\n// Pricing constants for modifiers and add-ons\nconst GLASS_PRICING = {\n    // Window type multipliers (relative to base quote price)\n    windows: {\n        'jqvmap1_ws': {\n            multiplier: 1.0,\n            name: 'Windscreen'\n        },\n        'jqvmap1_rw': {\n            multiplier: 0.8,\n            name: 'Rear Window'\n        },\n        'jqvmap1_df': {\n            multiplier: 0.5,\n            name: 'Front Passenger Door'\n        },\n        'jqvmap1_dg': {\n            multiplier: 0.5,\n            name: 'Front Driver Door'\n        },\n        'jqvmap1_dr': {\n            multiplier: 0.45,\n            name: 'Rear Passenger Door'\n        },\n        'jqvmap1_dd': {\n            multiplier: 0.45,\n            name: 'Rear Driver Door'\n        },\n        'jqvmap1_vp': {\n            multiplier: 0.25,\n            name: 'Front Passenger Vent'\n        },\n        'jqvmap1_vf': {\n            multiplier: 0.25,\n            name: 'Front Driver Vent'\n        },\n        'jqvmap1_vr': {\n            multiplier: 0.2,\n            name: 'Rear Passenger Vent'\n        },\n        'jqvmap1_vg': {\n            multiplier: 0.2,\n            name: 'Rear Driver Vent'\n        },\n        'jqvmap1_qr': {\n            multiplier: 0.3,\n            name: 'Rear Passenger Quarter'\n        },\n        'jqvmap1_qg': {\n            multiplier: 0.3,\n            name: 'Rear Driver Quarter'\n        }\n    },\n    // Note: Damage type multipliers are now handled within calculateMaterialsCost function\n    // Specification add-ons (flat fees)\n    specifications: {\n        'Rain Sensor': 25,\n        'Sensor': 25,\n        'Heated': 35,\n        'Camera': 50,\n        'Heads Up Display': 75,\n        'HUD': 75,\n        'Aerial Antenna': 15,\n        'No Modification': 0,\n        'Not Sure?': 10 // Small buffer for unknown specs\n    },\n    // Glass type multipliers\n    glassTypes: {\n        'OEM': 1.4,\n        'OEE': 1.0,\n        'standard': 1.0\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            message: 'Method not allowed'\n        });\n    }\n    try {\n        const { vehicleDetails, windowSpecifications, selectedWindows, windowDamage, deliveryType, glassType, glassColor } = req.body;\n        const quoteId = req.body.quoteId || `WC${Date.now()}${Math.random().toString(36).substr(2, 5).toUpperCase()}`;\n        if (!vehicleDetails?.registration) {\n            return res.status(400).json({\n                message: 'Vehicle registration is required'\n            });\n        }\n        console.log('Calculating quote with data:', {\n            selectedWindows,\n            windowDamage,\n            windowSpecifications,\n            glassType,\n            deliveryType,\n            glassColor,\n            registration: vehicleDetails.registration\n        });\n        // Fetch vehicle valuation data\n        const otrValue = await fetchVehicleValuation(vehicleDetails.registration);\n        // NEW PRICING STRUCTURE\n        // Fixed labour cost\n        const labourCost = 140;\n        // Calculate materials cost based on OTR price and window types\n        let materialsCost = calculateMaterialsCost(otrValue, selectedWindows, glassColor);\n        // Apply specification costs to materials\n        let specificationsCost = 0;\n        if (windowSpecifications && Array.isArray(windowSpecifications)) {\n            specificationsCost = windowSpecifications.reduce((total, spec)=>{\n                const specCost = spec in GLASS_PRICING.specifications ? GLASS_PRICING.specifications[spec] : 0;\n                return total + specCost;\n            }, 0);\n        }\n        materialsCost += specificationsCost;\n        // Apply glass type multiplier to materials\n        const glassMultiplier = glassType && glassType in GLASS_PRICING.glassTypes ? GLASS_PRICING.glassTypes[glassType] : 1.0;\n        materialsCost *= glassMultiplier;\n        // Calculate subtotal (labour + materials)\n        const subtotal = labourCost + materialsCost;\n        // Add 20% service fee on labour + materials\n        const serviceFee = subtotal * 0.2;\n        const totalBeforeVAT = subtotal + serviceFee;\n        // Add 20% VAT on the total\n        const vat = totalBeforeVAT * 0.2;\n        let totalPrice = totalBeforeVAT + vat;\n        // Apply delivery type fee\n        if (deliveryType === 'express') {\n            totalPrice += 90; // £90 additional for express delivery\n        }\n        // Round to nearest pound\n        totalPrice = Math.round(totalPrice);\n        // Ensure minimum total price is still £70\n        totalPrice = Math.max(totalPrice, 70);\n        // Create detailed breakdown for transparency\n        const breakdown = {\n            windowCosts: [],\n            specificationCosts: specificationsCost,\n            serviceFee: Math.round(serviceFee * 100) / 100,\n            glassTypeMultiplier: glassMultiplier,\n            baseTotal: Math.round(subtotal * 100) / 100,\n            vehicleBasedPrice: calculateMaterialsCost(otrValue, selectedWindows, glassColor),\n            otrPrice: otrValue\n        };\n        // Add detailed breakdown info for debugging\n        console.log('Price Breakdown:', {\n            labourCost,\n            materialsCost: Math.round(materialsCost * 100) / 100,\n            subtotal: Math.round(subtotal * 100) / 100,\n            serviceFee: Math.round(serviceFee * 100) / 100,\n            totalBeforeVAT: Math.round(totalBeforeVAT * 100) / 100,\n            vat: Math.round(vat * 100) / 100,\n            finalPrice: totalPrice,\n            glassType,\n            deliveryType\n        });\n        try {\n            // First, try to update the existing record in Supabase\n            const { data: updateData, error: updateError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabase.from('MasterCustomer').update({\n                quote_price: totalPrice,\n                service_type: deliveryType,\n                glass_type: glassType,\n                otr_price: otrValue\n            }).eq('quote_id', quoteId).select();\n            if (updateError || !updateData || updateData.length === 0) {\n                console.log('Update failed or no record found, attempting upsert...');\n                // If update fails or no record exists, create a new record\n                const { data: insertData, error: insertError } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_0__.supabase.from('MasterCustomer').insert({\n                    quote_id: quoteId,\n                    quote_price: totalPrice,\n                    service_type: deliveryType,\n                    glass_type: glassType,\n                    otr_price: otrValue,\n                    created_at: new Date().toISOString(),\n                    updated_at: new Date().toISOString()\n                }).select();\n                if (insertError) {\n                    console.error('Supabase insert error:', insertError);\n                } else {\n                    console.log('Successfully created new quote record with price:', totalPrice);\n                }\n            } else {\n                console.log('Successfully updated quote price in Supabase:', totalPrice);\n            }\n        } catch (supabaseError) {\n            console.error('Supabase error:', supabaseError);\n        // Continue execution even if Supabase operation fails\n        }\n        return res.status(200).json({\n            success: true,\n            price: totalPrice,\n            quoteId,\n            breakdown: {\n                ...breakdown,\n                // Add detailed breakdown for frontend display\n                labourCost: labourCost,\n                materialsCost: Math.round(materialsCost * 100) / 100,\n                subtotal: Math.round(subtotal * 100) / 100,\n                serviceFee: Math.round(serviceFee * 100) / 100,\n                totalBeforeVAT: Math.round(totalBeforeVAT * 100) / 100,\n                vat: Math.round(vat * 100) / 100,\n                finalPrice: totalPrice,\n                glassType: glassType,\n                deliveryType: deliveryType\n            }\n        });\n    } catch (error) {\n        console.error('Error calculating quote:', error);\n        return res.status(500).json({\n            message: 'Failed to calculate quote'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsaURBQWlEMkU7WUFDL0Q7UUFDRixFQUFFLE9BQU8wQixlQUFlO1lBQ3RCdkcsUUFBUUMsS0FBSyxDQUFDLG1CQUFtQnNHO1FBQ2pDLHNEQUFzRDtRQUN4RDtRQUVBLE9BQU90RCxJQUFJQyxNQUFNLENBQUMsS0FBSzFDLElBQUksQ0FBQztZQUMxQmdHLFNBQVM7WUFDVEMsT0FBTzVCO1lBQ1BuQjtZQUNBb0IsV0FBVztnQkFDVCxHQUFHQSxTQUFTO2dCQUNaLDhDQUE4QztnQkFDOUNiLFlBQVlBO2dCQUNaQyxlQUFlNUIsS0FBS0UsS0FBSyxDQUFDMEIsZ0JBQWdCLE9BQU87Z0JBQ2pETyxVQUFVbkMsS0FBS0UsS0FBSyxDQUFDaUMsV0FBVyxPQUFPO2dCQUN2Q0MsWUFBWXBDLEtBQUtFLEtBQUssQ0FBQ2tDLGFBQWEsT0FBTztnQkFDM0NDLGdCQUFnQnJDLEtBQUtFLEtBQUssQ0FBQ21DLGlCQUFpQixPQUFPO2dCQUNuREMsS0FBS3RDLEtBQUtFLEtBQUssQ0FBQ29DLE1BQU0sT0FBTztnQkFDN0JRLFlBQVlQO2dCQUNackIsV0FBV0E7Z0JBQ1hELGNBQWNBO1lBQ2hCO1FBQ0Y7SUFDRixFQUFFLE9BQU90RCxPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQyw0QkFBNEJBO1FBQzFDLE9BQU9nRCxJQUFJQyxNQUFNLENBQUMsS0FBSzFDLElBQUksQ0FBQztZQUFFMkMsU0FBUztRQUE0QjtJQUNyRTtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvbXVoYW1tYWRhbGkvRGVza3RvcC9XaW5kc2NyZWVuQ29tcGFyZS93aW5kc2hpZWxkX2NvbXBhcmUvV2luZENvbXBhcmUvcGFnZXMvYXBpL2NhbGN1bGF0ZS1xdW90ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSAnLi4vLi4vbGliL3N1cGFiYXNlQ2xpZW50JztcblxuLy8gVHlwZSBkZWZpbml0aW9uc1xudHlwZSBXaW5kb3dJZCA9ICdqcXZtYXAxX3dzJyB8ICdqcXZtYXAxX3J3JyB8ICdqcXZtYXAxX2RmJyB8ICdqcXZtYXAxX2RnJyB8ICdqcXZtYXAxX2RyJyB8ICdqcXZtYXAxX2RkJyB8ICdqcXZtYXAxX3ZwJyB8ICdqcXZtYXAxX3ZmJyB8ICdqcXZtYXAxX3ZyJyB8ICdqcXZtYXAxX3ZnJyB8ICdqcXZtYXAxX3FyJyB8ICdqcXZtYXAxX3FnJztcbi8vIE5vdGU6IERhbWFnZSB0eXBlcyBhcmUgY29sbGVjdGVkIGJ1dCBub3QgdXNlZCBpbiBwcmljaW5nIGNhbGN1bGF0aW9uc1xudHlwZSBTcGVjaWZpY2F0aW9uVHlwZSA9ICdSYWluIFNlbnNvcicgfCAnU2Vuc29yJyB8ICdIZWF0ZWQnIHwgJ0NhbWVyYScgfCAnSGVhZHMgVXAgRGlzcGxheScgfCAnSFVEJyB8ICdBZXJpYWwgQW50ZW5uYScgfCAnTm8gTW9kaWZpY2F0aW9uJyB8ICdOb3QgU3VyZT8nO1xudHlwZSBHbGFzc1R5cGUgPSAnT0VNJyB8ICdPRUUnIHwgJ3N0YW5kYXJkJztcblxuaW50ZXJmYWNlIFdpbmRvd0Nvc3Qge1xuICB3aW5kb3dJZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGJhc2VDb3N0OiBudW1iZXI7XG4gIHByaXZhY3lDb3N0OiBudW1iZXI7XG4gIHRvdGFsQ29zdDogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgUHJpY2VCcmVha2Rvd24ge1xuICB3aW5kb3dDb3N0czogV2luZG93Q29zdFtdO1xuICBzcGVjaWZpY2F0aW9uQ29zdHM6IG51bWJlcjtcbiAgc2VydmljZUZlZTogbnVtYmVyO1xuICBnbGFzc1R5cGVNdWx0aXBsaWVyOiBudW1iZXI7XG4gIGJhc2VUb3RhbDogbnVtYmVyO1xuICB2ZWhpY2xlQmFzZWRQcmljZT86IG51bWJlcjtcbiAgb3RyUHJpY2U/OiBudW1iZXIgfCBudWxsO1xufVxuXG4vLyBGZXRjaCB2ZWhpY2xlIHZhbHVhdGlvbiBkYXRhXG5hc3luYyBmdW5jdGlvbiBmZXRjaFZlaGljbGVWYWx1YXRpb24ocmVnaXN0cmF0aW9uOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5VS19WRUhJQ0xFX0RBVEFfQVBJX0tFWTtcbiAgICBcbiAgICBpZiAoIWFwaUtleSkge1xuICAgICAgY29uc29sZS5lcnJvcignVUtfVkVISUNMRV9EQVRBX0FQSV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IHNldCcpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYEZldGNoaW5nIHZhbHVhdGlvbiBkYXRhIGZvciByZWdpc3RyYXRpb246ICR7cmVnaXN0cmF0aW9ufWApO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICBgaHR0cHM6Ly91azEudWt2ZWhpY2xlZGF0YS5jby51ay9hcGkvZGF0YXBhY2thZ2UvVmFsdWF0aW9uRGF0YT92PTImYXBpX251bGxpdGVtcz0xJmF1dGhfYXBpa2V5PSR7YXBpS2V5fSZrZXlfVlJNPSR7cmVnaXN0cmF0aW9ufWAsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgY29uc29sZS5sb2coJ0Z1bGwgVmFsdWF0aW9uIEFQSSByZXNwb25zZTonLCBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKSk7XG5cbiAgICBpZiAoZGF0YS5SZXNwb25zZT8uU3RhdHVzQ29kZSA9PT0gXCJTdWNjZXNzXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdBUEkgY2FsbCBzdWNjZXNzZnVsLCBjaGVja2luZyBmb3IgdmFsdWF0aW9uIGRhdGEuLi4nKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgdGhlIGNvcnJlY3QgcGF0aCBmb3IgdmFsdWF0aW9uIGRhdGFcbiAgICAgIGNvbnN0IGRhdGFJdGVtcyA9IGRhdGEuUmVzcG9uc2UuRGF0YUl0ZW1zO1xuICAgICAgaWYgKGRhdGFJdGVtcyAmJiBkYXRhSXRlbXMuVmFsdWF0aW9uTGlzdCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVmFsdWF0aW9uTGlzdCBmb3VuZDonLCBKU09OLnN0cmluZ2lmeShkYXRhSXRlbXMuVmFsdWF0aW9uTGlzdCwgbnVsbCwgMikpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgb3RyVmFsdWUgPSBkYXRhSXRlbXMuVmFsdWF0aW9uTGlzdC5PVFI7XG4gICAgICAgIFxuICAgICAgICBpZiAob3RyVmFsdWUpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgT1RSIHZhbHVlIGZvdW5kOiDCoyR7b3RyVmFsdWV9YCk7XG4gICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQob3RyVmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdPVFIgdmFsdWUgbm90IGZvdW5kIGluIFZhbHVhdGlvbkxpc3QnKTtcbiAgICAgICAgICBjb25zb2xlLmxvZygnQXZhaWxhYmxlIGZpZWxkcyBpbiBWYWx1YXRpb25MaXN0OicsIE9iamVjdC5rZXlzKGRhdGFJdGVtcy5WYWx1YXRpb25MaXN0KSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdWYWx1YXRpb25MaXN0IG5vdCBmb3VuZCBpbiBEYXRhSXRlbXMnKTtcbiAgICAgICAgY29uc29sZS5sb2coJ0F2YWlsYWJsZSBEYXRhSXRlbXMgZmllbGRzOicsIGRhdGFJdGVtcyA/IE9iamVjdC5rZXlzKGRhdGFJdGVtcykgOiAnTm9uZScpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhgQVBJIGNhbGwgZmFpbGVkIHdpdGggc3RhdHVzOiAke2RhdGEuUmVzcG9uc2U/LlN0YXR1c0NvZGV9YCk7XG4gICAgICBjb25zb2xlLmxvZyhgU3RhdHVzIG1lc3NhZ2U6ICR7ZGF0YS5SZXNwb25zZT8uU3RhdHVzTWVzc2FnZX1gKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIG51bGw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdmVoaWNsZSB2YWx1YXRpb246JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8vIENhbGN1bGF0ZSBtYXRlcmlhbHMgY29zdCBiYXNlZCBvbiBPVFIgcHJpY2UgYW5kIHdpbmRvdyB0eXBlXG4vLyBFeGFtcGxlOiBGb3IgT1RSIHByaWNlIMKjMjAsMDAwIHdpdGggV2luZHNjcmVlbiArIEZyb250IERyaXZlciBEb29yICsgUmVhciBXaW5kb3cgKyBSZWFyIERyaXZlciBEb29yICsgUmVhciBQYXNzZW5nZXIgRG9vciArIEZyb250IFBhc3NlbmdlciBEb29yOlxuLy8gLSBXaW5kc2NyZWVuOiAxLjIlIMOXIMKjMjAsMDAwID0gwqMyNDBcbi8vIC0gRnJvbnQgRHJpdmVyIERvb3I6IDAuMjUlIMOXIMKjMjAsMDAwID0gwqM1MCAgXG4vLyAtIFJlYXIgV2luZG93OiAwLjUlIMOXIMKjMjAsMDAwID0gwqMxMDBcbi8vIC0gUmVhciBEcml2ZXIgRG9vcjogMC4yNSUgw5cgwqMyMCwwMDAgPSDCozUwXG4vLyAtIFJlYXIgUGFzc2VuZ2VyIERvb3I6IDAuMjUlIMOXIMKjMjAsMDAwID0gwqM1MFxuLy8gLSBGcm9udCBQYXNzZW5nZXIgRG9vcjogMC4yNSUgw5cgwqMyMCwwMDAgPSDCozUwXG4vLyBUb3RhbDogwqM1NDAgKCsgwqMzMCBwZXIgd2luZG93IGlmIHRpbnRlZClcbmZ1bmN0aW9uIGNhbGN1bGF0ZU1hdGVyaWFsc0Nvc3Qob3RyUHJpY2U6IG51bWJlciB8IG51bGwsIHNlbGVjdGVkV2luZG93czogc3RyaW5nW10sIGdsYXNzQ29sb3I/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KTogbnVtYmVyIHtcbiAgaWYgKCFvdHJQcmljZSB8fCBpc05hTihvdHJQcmljZSkpIHtcbiAgICBjb25zb2xlLmxvZygnT1RSIHByaWNlIG5vdCBhdmFpbGFibGUsIHVzaW5nIG1pbmltdW0gbWF0ZXJpYWxzIGNvc3Qgb2YgwqM3MCcpO1xuICAgIHJldHVybiA3MDtcbiAgfVxuXG4gIC8vIFdpbmRvdyB0eXBlIHBlcmNlbnRhZ2UgbXVsdGlwbGllcnMgYmFzZWQgb24gT1RSIHByaWNlXG4gIGNvbnN0IHdpbmRvd09UUlBlcmNlbnRhZ2VzID0ge1xuICAgICdqcXZtYXAxX3dzJzogMC4wMTIsICAgIC8vIFdpbmRzY3JlZW4gLSAxLjIlXG4gICAgJ2pxdm1hcDFfcncnOiAwLjAwNSwgICAgLy8gUmVhciBXaW5kb3cgLSAwLjUlXG4gICAgJ2pxdm1hcDFfZGYnOiAwLjAwMjUsICAgLy8gRnJvbnQgUGFzc2VuZ2VyIERvb3IgLSAwLjI1JSAoc2lkZXMpXG4gICAgJ2pxdm1hcDFfZGcnOiAwLjAwMjUsICAgLy8gRnJvbnQgRHJpdmVyIERvb3IgLSAwLjI1JSAoc2lkZXMpXG4gICAgJ2pxdm1hcDFfZHInOiAwLjAwMjUsICAgLy8gUmVhciBQYXNzZW5nZXIgRG9vciAtIDAuMjUlIChzaWRlcylcbiAgICAnanF2bWFwMV9kZCc6IDAuMDAyNSwgICAvLyBSZWFyIERyaXZlciBEb29yIC0gMC4yNSUgKHNpZGVzKVxuICAgICdqcXZtYXAxX3ZwJzogMC4wMDUsICAgIC8vIEZyb250IFBhc3NlbmdlciBWZW50IC0gMC41JSAocXVhcnQgbGlnaHQpXG4gICAgJ2pxdm1hcDFfdmYnOiAwLjAwNSwgICAgLy8gRnJvbnQgRHJpdmVyIFZlbnQgLSAwLjUlIChxdWFydCBsaWdodClcbiAgICAnanF2bWFwMV92cic6IDAuMDA1LCAgICAvLyBSZWFyIFBhc3NlbmdlciBWZW50IC0gMC41JSAocXVhcnQgbGlnaHQpXG4gICAgJ2pxdm1hcDFfdmcnOiAwLjAwNSwgICAgLy8gUmVhciBEcml2ZXIgVmVudCAtIDAuNSUgKHF1YXJ0IGxpZ2h0KVxuICAgICdqcXZtYXAxX3FyJzogMC4wMDQsICAgIC8vIFJlYXIgUGFzc2VuZ2VyIFF1YXJ0ZXIgTGlnaHQgLSAwLjQlIChxdWFydGVyKVxuICAgICdqcXZtYXAxX3FnJzogMC4wMDQgICAgIC8vIFJlYXIgRHJpdmVyIFF1YXJ0ZXIgLSAwLjQlIChxdWFydGVyKVxuICB9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG5cbiAgbGV0IHRvdGFsTWF0ZXJpYWxzQ29zdCA9IDA7XG5cbiAgaWYgKHNlbGVjdGVkV2luZG93cyAmJiBBcnJheS5pc0FycmF5KHNlbGVjdGVkV2luZG93cykpIHtcbiAgICBmb3IgKGNvbnN0IHdpbmRvd0lkIG9mIHNlbGVjdGVkV2luZG93cykge1xuICAgICAgY29uc3QgcGVyY2VudGFnZSA9IHdpbmRvd09UUlBlcmNlbnRhZ2VzW3dpbmRvd0lkXTtcbiAgICAgIGlmIChwZXJjZW50YWdlKSB7XG4gICAgICAgIGNvbnN0IHdpbmRvd0Nvc3QgPSBvdHJQcmljZSAqIHBlcmNlbnRhZ2U7XG4gICAgICAgIHRvdGFsTWF0ZXJpYWxzQ29zdCArPSB3aW5kb3dDb3N0O1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHByaXZhY3kvdGludGluZyBhbmQgYWRkIMKjMzAgaWYgYXBwbGljYWJsZVxuICAgICAgICBsZXQgcHJpdmFjeUNvc3QgPSAwO1xuICAgICAgICBpZiAoZ2xhc3NDb2xvciAmJiBnbGFzc0NvbG9yW3dpbmRvd0lkXSA9PT0gJ1RpbnRlZCBCbGFjaycpIHtcbiAgICAgICAgICBwcml2YWN5Q29zdCA9IDMwO1xuICAgICAgICAgIHRvdGFsTWF0ZXJpYWxzQ29zdCArPSBwcml2YWN5Q29zdDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgcHJpdmFjeU5vdGUgPSBwcml2YWN5Q29zdCA+IDAgPyBgICsgwqMke3ByaXZhY3lDb3N0fSAocHJpdmFjeSlgIDogJyc7XG4gICAgICAgIGNvbnNvbGUubG9nKGBXaW5kb3cgJHt3aW5kb3dJZH06ICR7cGVyY2VudGFnZSAqIDEwMH0lIG9mIMKjJHtvdHJQcmljZX0gPSDCoyR7d2luZG93Q29zdC50b0ZpeGVkKDIpfSR7cHJpdmFjeU5vdGV9ID0gwqMkeyh3aW5kb3dDb3N0ICsgcHJpdmFjeUNvc3QpLnRvRml4ZWQoMil9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhgVW5rbm93biB3aW5kb3cgdHlwZTogJHt3aW5kb3dJZH0sIHVzaW5nIGRlZmF1bHQgMC4yNSUgb2YgT1RSYCk7XG4gICAgICAgIGNvbnN0IHdpbmRvd0Nvc3QgPSBvdHJQcmljZSAqIDAuMDAyNTsgLy8gRGVmYXVsdCAwLjI1JVxuICAgICAgICB0b3RhbE1hdGVyaWFsc0Nvc3QgKz0gd2luZG93Q29zdDtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGZvciBwcml2YWN5L3RpbnRpbmcgYW5kIGFkZCDCozMwIGlmIGFwcGxpY2FibGVcbiAgICAgICAgbGV0IHByaXZhY3lDb3N0ID0gMDtcbiAgICAgICAgaWYgKGdsYXNzQ29sb3IgJiYgZ2xhc3NDb2xvclt3aW5kb3dJZF0gPT09ICdUaW50ZWQgQmxhY2snKSB7XG4gICAgICAgICAgcHJpdmFjeUNvc3QgPSAzMDtcbiAgICAgICAgICB0b3RhbE1hdGVyaWFsc0Nvc3QgKz0gcHJpdmFjeUNvc3Q7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHByaXZhY3lOb3RlID0gcHJpdmFjeUNvc3QgPiAwID8gYCArIMKjJHtwcml2YWN5Q29zdH0gKHByaXZhY3kpYCA6ICcnO1xuICAgICAgICBjb25zb2xlLmxvZyhgV2luZG93ICR7d2luZG93SWR9ICh1bmtub3duKTogMC4yNSUgb2YgwqMke290clByaWNlfSA9IMKjJHt3aW5kb3dDb3N0LnRvRml4ZWQoMil9JHtwcml2YWN5Tm90ZX0gPSDCoyR7KHdpbmRvd0Nvc3QgKyBwcml2YWN5Q29zdCkudG9GaXhlZCgyKX1gKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBFbnN1cmUgbWluaW11bSBtYXRlcmlhbHMgY29zdCBpcyDCozcwXG4gIGNvbnN0IGZpbmFsQ29zdCA9IE1hdGgubWF4KHRvdGFsTWF0ZXJpYWxzQ29zdCwgNzApO1xuICBjb25zb2xlLmxvZyhgVG90YWwgbWF0ZXJpYWxzIGNvc3Q6IMKjJHt0b3RhbE1hdGVyaWFsc0Nvc3QudG9GaXhlZCgyKX0sIEZpbmFsIGNvc3QgKG1pbiDCozcwKTogwqMke2ZpbmFsQ29zdC50b0ZpeGVkKDIpfWApO1xuICBcbiAgcmV0dXJuIE1hdGgucm91bmQoZmluYWxDb3N0ICogMTAwKSAvIDEwMDsgLy8gUm91bmQgdG8gMiBkZWNpbWFsIHBsYWNlc1xufVxuXG4vLyBQcmljaW5nIGNvbnN0YW50cyBmb3IgbW9kaWZpZXJzIGFuZCBhZGQtb25zXG5jb25zdCBHTEFTU19QUklDSU5HID0ge1xuICAvLyBXaW5kb3cgdHlwZSBtdWx0aXBsaWVycyAocmVsYXRpdmUgdG8gYmFzZSBxdW90ZSBwcmljZSlcbiAgd2luZG93czoge1xuICAgICdqcXZtYXAxX3dzJzogeyBtdWx0aXBsaWVyOiAxLjAsIG5hbWU6ICdXaW5kc2NyZWVuJyB9LCAgICAgIC8vIEJhc2UgbXVsdGlwbGllciBmb3Igd2luZHNjcmVlblxuICAgICdqcXZtYXAxX3J3JzogeyBtdWx0aXBsaWVyOiAwLjgsIG5hbWU6ICdSZWFyIFdpbmRvdycgfSwgICAgIC8vIDgwJSBvZiB3aW5kc2NyZWVuIHByaWNlXG4gICAgJ2pxdm1hcDFfZGYnOiB7IG11bHRpcGxpZXI6IDAuNSwgbmFtZTogJ0Zyb250IFBhc3NlbmdlciBEb29yJyB9LFxuICAgICdqcXZtYXAxX2RnJzogeyBtdWx0aXBsaWVyOiAwLjUsIG5hbWU6ICdGcm9udCBEcml2ZXIgRG9vcicgfSxcbiAgICAnanF2bWFwMV9kcic6IHsgbXVsdGlwbGllcjogMC40NSwgbmFtZTogJ1JlYXIgUGFzc2VuZ2VyIERvb3InIH0sXG4gICAgJ2pxdm1hcDFfZGQnOiB7IG11bHRpcGxpZXI6IDAuNDUsIG5hbWU6ICdSZWFyIERyaXZlciBEb29yJyB9LFxuICAgICdqcXZtYXAxX3ZwJzogeyBtdWx0aXBsaWVyOiAwLjI1LCBuYW1lOiAnRnJvbnQgUGFzc2VuZ2VyIFZlbnQnIH0sXG4gICAgJ2pxdm1hcDFfdmYnOiB7IG11bHRpcGxpZXI6IDAuMjUsIG5hbWU6ICdGcm9udCBEcml2ZXIgVmVudCcgfSxcbiAgICAnanF2bWFwMV92cic6IHsgbXVsdGlwbGllcjogMC4yLCBuYW1lOiAnUmVhciBQYXNzZW5nZXIgVmVudCcgfSxcbiAgICAnanF2bWFwMV92Zyc6IHsgbXVsdGlwbGllcjogMC4yLCBuYW1lOiAnUmVhciBEcml2ZXIgVmVudCcgfSxcbiAgICAnanF2bWFwMV9xcic6IHsgbXVsdGlwbGllcjogMC4zLCBuYW1lOiAnUmVhciBQYXNzZW5nZXIgUXVhcnRlcicgfSxcbiAgICAnanF2bWFwMV9xZyc6IHsgbXVsdGlwbGllcjogMC4zLCBuYW1lOiAnUmVhciBEcml2ZXIgUXVhcnRlcicgfVxuICB9IGFzIFJlY29yZDxXaW5kb3dJZCwgeyBtdWx0aXBsaWVyOiBudW1iZXI7IG5hbWU6IHN0cmluZyB9PixcbiAgXG4gIC8vIE5vdGU6IERhbWFnZSB0eXBlIG11bHRpcGxpZXJzIGFyZSBub3cgaGFuZGxlZCB3aXRoaW4gY2FsY3VsYXRlTWF0ZXJpYWxzQ29zdCBmdW5jdGlvblxuICBcbiAgLy8gU3BlY2lmaWNhdGlvbiBhZGQtb25zIChmbGF0IGZlZXMpXG4gIHNwZWNpZmljYXRpb25zOiB7XG4gICAgJ1JhaW4gU2Vuc29yJzogMjUsXG4gICAgJ1NlbnNvcic6IDI1LFxuICAgICdIZWF0ZWQnOiAzNSxcbiAgICAnQ2FtZXJhJzogNTAsXG4gICAgJ0hlYWRzIFVwIERpc3BsYXknOiA3NSxcbiAgICAnSFVEJzogNzUsXG4gICAgJ0FlcmlhbCBBbnRlbm5hJzogMTUsXG4gICAgJ05vIE1vZGlmaWNhdGlvbic6IDAsXG4gICAgJ05vdCBTdXJlPyc6IDEwICAvLyBTbWFsbCBidWZmZXIgZm9yIHVua25vd24gc3BlY3NcbiAgfSBhcyBSZWNvcmQ8U3BlY2lmaWNhdGlvblR5cGUsIG51bWJlcj4sXG4gIFxuICAvLyBHbGFzcyB0eXBlIG11bHRpcGxpZXJzXG4gIGdsYXNzVHlwZXM6IHtcbiAgICAnT0VNJzogMS40LCAgICAvLyBPcmlnaW5hbCBFcXVpcG1lbnQgTWFudWZhY3R1cmVyIC0gbW9yZSBleHBlbnNpdmVcbiAgICAnT0VFJzogMS4wLCAgICAvLyBPcmlnaW5hbCBFcXVpcG1lbnQgRXF1aXZhbGVudCAtIHN0YW5kYXJkIHByaWNlXG4gICAgJ3N0YW5kYXJkJzogMS4wXG4gIH0gYXMgUmVjb3JkPEdsYXNzVHlwZSwgbnVtYmVyPlxufTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgbWVzc2FnZTogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgXG4gICAgICB2ZWhpY2xlRGV0YWlscywgXG4gICAgICB3aW5kb3dTcGVjaWZpY2F0aW9ucywgXG4gICAgICBzZWxlY3RlZFdpbmRvd3MsXG4gICAgICB3aW5kb3dEYW1hZ2UsXG4gICAgICBkZWxpdmVyeVR5cGUsXG4gICAgICBnbGFzc1R5cGUsXG4gICAgICBnbGFzc0NvbG9yXG4gICAgfSA9IHJlcS5ib2R5O1xuICAgIFxuICAgIGNvbnN0IHF1b3RlSWQgPSByZXEuYm9keS5xdW90ZUlkIHx8IGBXQyR7RGF0ZS5ub3coKX0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA1KS50b1VwcGVyQ2FzZSgpfWA7XG4gICAgXG4gICAgaWYgKCF2ZWhpY2xlRGV0YWlscz8ucmVnaXN0cmF0aW9uKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnVmVoaWNsZSByZWdpc3RyYXRpb24gaXMgcmVxdWlyZWQnIH0pO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdDYWxjdWxhdGluZyBxdW90ZSB3aXRoIGRhdGE6Jywge1xuICAgICAgc2VsZWN0ZWRXaW5kb3dzLFxuICAgICAgd2luZG93RGFtYWdlLFxuICAgICAgd2luZG93U3BlY2lmaWNhdGlvbnMsXG4gICAgICBnbGFzc1R5cGUsXG4gICAgICBkZWxpdmVyeVR5cGUsXG4gICAgICBnbGFzc0NvbG9yLFxuICAgICAgcmVnaXN0cmF0aW9uOiB2ZWhpY2xlRGV0YWlscy5yZWdpc3RyYXRpb25cbiAgICB9KTtcblxuICAgIC8vIEZldGNoIHZlaGljbGUgdmFsdWF0aW9uIGRhdGFcbiAgICBjb25zdCBvdHJWYWx1ZSA9IGF3YWl0IGZldGNoVmVoaWNsZVZhbHVhdGlvbih2ZWhpY2xlRGV0YWlscy5yZWdpc3RyYXRpb24pO1xuXG4gICAgLy8gTkVXIFBSSUNJTkcgU1RSVUNUVVJFXG4gICAgLy8gRml4ZWQgbGFib3VyIGNvc3RcbiAgICBjb25zdCBsYWJvdXJDb3N0ID0gMTQwO1xuICAgIFxuICAgIC8vIENhbGN1bGF0ZSBtYXRlcmlhbHMgY29zdCBiYXNlZCBvbiBPVFIgcHJpY2UgYW5kIHdpbmRvdyB0eXBlc1xuICAgIGxldCBtYXRlcmlhbHNDb3N0ID0gY2FsY3VsYXRlTWF0ZXJpYWxzQ29zdChvdHJWYWx1ZSwgc2VsZWN0ZWRXaW5kb3dzLCBnbGFzc0NvbG9yKTtcbiAgICBcbiAgICAvLyBBcHBseSBzcGVjaWZpY2F0aW9uIGNvc3RzIHRvIG1hdGVyaWFsc1xuICAgIGxldCBzcGVjaWZpY2F0aW9uc0Nvc3QgPSAwO1xuICAgIGlmICh3aW5kb3dTcGVjaWZpY2F0aW9ucyAmJiBBcnJheS5pc0FycmF5KHdpbmRvd1NwZWNpZmljYXRpb25zKSkge1xuICAgICAgc3BlY2lmaWNhdGlvbnNDb3N0ID0gd2luZG93U3BlY2lmaWNhdGlvbnMucmVkdWNlKCh0b3RhbCwgc3BlYykgPT4ge1xuICAgICAgICBjb25zdCBzcGVjQ29zdCA9IChzcGVjIGFzIFNwZWNpZmljYXRpb25UeXBlKSBpbiBHTEFTU19QUklDSU5HLnNwZWNpZmljYXRpb25zXG4gICAgICAgICAgPyBHTEFTU19QUklDSU5HLnNwZWNpZmljYXRpb25zW3NwZWMgYXMgU3BlY2lmaWNhdGlvblR5cGVdXG4gICAgICAgICAgOiAwO1xuICAgICAgICByZXR1cm4gdG90YWwgKyBzcGVjQ29zdDtcbiAgICAgIH0sIDApO1xuICAgIH1cbiAgICBtYXRlcmlhbHNDb3N0ICs9IHNwZWNpZmljYXRpb25zQ29zdDtcbiAgICBcbiAgICAvLyBBcHBseSBnbGFzcyB0eXBlIG11bHRpcGxpZXIgdG8gbWF0ZXJpYWxzXG4gICAgY29uc3QgZ2xhc3NNdWx0aXBsaWVyID0gZ2xhc3NUeXBlICYmIChnbGFzc1R5cGUgYXMgR2xhc3NUeXBlKSBpbiBHTEFTU19QUklDSU5HLmdsYXNzVHlwZXNcbiAgICAgID8gR0xBU1NfUFJJQ0lORy5nbGFzc1R5cGVzW2dsYXNzVHlwZSBhcyBHbGFzc1R5cGVdXG4gICAgICA6IDEuMDtcbiAgICBtYXRlcmlhbHNDb3N0ICo9IGdsYXNzTXVsdGlwbGllcjtcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgc3VidG90YWwgKGxhYm91ciArIG1hdGVyaWFscylcbiAgICBjb25zdCBzdWJ0b3RhbCA9IGxhYm91ckNvc3QgKyBtYXRlcmlhbHNDb3N0O1xuICAgIFxuICAgIC8vIEFkZCAyMCUgc2VydmljZSBmZWUgb24gbGFib3VyICsgbWF0ZXJpYWxzXG4gICAgY29uc3Qgc2VydmljZUZlZSA9IHN1YnRvdGFsICogMC4yO1xuICAgIGNvbnN0IHRvdGFsQmVmb3JlVkFUID0gc3VidG90YWwgKyBzZXJ2aWNlRmVlO1xuICAgIFxuICAgIC8vIEFkZCAyMCUgVkFUIG9uIHRoZSB0b3RhbFxuICAgIGNvbnN0IHZhdCA9IHRvdGFsQmVmb3JlVkFUICogMC4yO1xuICAgIGxldCB0b3RhbFByaWNlID0gdG90YWxCZWZvcmVWQVQgKyB2YXQ7XG4gICAgXG4gICAgLy8gQXBwbHkgZGVsaXZlcnkgdHlwZSBmZWVcbiAgICBpZiAoZGVsaXZlcnlUeXBlID09PSAnZXhwcmVzcycpIHtcbiAgICAgIHRvdGFsUHJpY2UgKz0gOTA7IC8vIMKjOTAgYWRkaXRpb25hbCBmb3IgZXhwcmVzcyBkZWxpdmVyeVxuICAgIH1cbiAgICBcbiAgICAvLyBSb3VuZCB0byBuZWFyZXN0IHBvdW5kXG4gICAgdG90YWxQcmljZSA9IE1hdGgucm91bmQodG90YWxQcmljZSk7XG4gICAgXG4gICAgLy8gRW5zdXJlIG1pbmltdW0gdG90YWwgcHJpY2UgaXMgc3RpbGwgwqM3MFxuICAgIHRvdGFsUHJpY2UgPSBNYXRoLm1heCh0b3RhbFByaWNlLCA3MCk7XG5cbiAgICAvLyBDcmVhdGUgZGV0YWlsZWQgYnJlYWtkb3duIGZvciB0cmFuc3BhcmVuY3lcbiAgICBjb25zdCBicmVha2Rvd246IFByaWNlQnJlYWtkb3duID0ge1xuICAgICAgd2luZG93Q29zdHM6IFtdLCAvLyBLZWVwIGVtcHR5IGZvciBjb21wYXRpYmlsaXR5XG4gICAgICBzcGVjaWZpY2F0aW9uQ29zdHM6IHNwZWNpZmljYXRpb25zQ29zdCxcbiAgICAgIHNlcnZpY2VGZWU6IE1hdGgucm91bmQoc2VydmljZUZlZSAqIDEwMCkgLyAxMDAsXG4gICAgICBnbGFzc1R5cGVNdWx0aXBsaWVyOiBnbGFzc011bHRpcGxpZXIsXG4gICAgICBiYXNlVG90YWw6IE1hdGgucm91bmQoc3VidG90YWwgKiAxMDApIC8gMTAwLFxuICAgICAgdmVoaWNsZUJhc2VkUHJpY2U6IGNhbGN1bGF0ZU1hdGVyaWFsc0Nvc3Qob3RyVmFsdWUsIHNlbGVjdGVkV2luZG93cywgZ2xhc3NDb2xvciksXG4gICAgICBvdHJQcmljZTogb3RyVmFsdWVcbiAgICB9O1xuXG4gICAgLy8gQWRkIGRldGFpbGVkIGJyZWFrZG93biBpbmZvIGZvciBkZWJ1Z2dpbmdcbiAgICBjb25zb2xlLmxvZygnUHJpY2UgQnJlYWtkb3duOicsIHtcbiAgICAgIGxhYm91ckNvc3QsXG4gICAgICBtYXRlcmlhbHNDb3N0OiBNYXRoLnJvdW5kKG1hdGVyaWFsc0Nvc3QgKiAxMDApIC8gMTAwLFxuICAgICAgc3VidG90YWw6IE1hdGgucm91bmQoc3VidG90YWwgKiAxMDApIC8gMTAwLFxuICAgICAgc2VydmljZUZlZTogTWF0aC5yb3VuZChzZXJ2aWNlRmVlICogMTAwKSAvIDEwMCxcbiAgICAgIHRvdGFsQmVmb3JlVkFUOiBNYXRoLnJvdW5kKHRvdGFsQmVmb3JlVkFUICogMTAwKSAvIDEwMCxcbiAgICAgIHZhdDogTWF0aC5yb3VuZCh2YXQgKiAxMDApIC8gMTAwLFxuICAgICAgZmluYWxQcmljZTogdG90YWxQcmljZSxcbiAgICAgIGdsYXNzVHlwZSxcbiAgICAgIGRlbGl2ZXJ5VHlwZVxuICAgIH0pO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEZpcnN0LCB0cnkgdG8gdXBkYXRlIHRoZSBleGlzdGluZyByZWNvcmQgaW4gU3VwYWJhc2VcbiAgICAgIGNvbnN0IHsgZGF0YTogdXBkYXRlRGF0YSwgZXJyb3I6IHVwZGF0ZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnTWFzdGVyQ3VzdG9tZXInKVxuICAgICAgICAudXBkYXRlKHtcbiAgICAgICAgICBxdW90ZV9wcmljZTogdG90YWxQcmljZSxcbiAgICAgICAgICBzZXJ2aWNlX3R5cGU6IGRlbGl2ZXJ5VHlwZSxcbiAgICAgICAgICBnbGFzc190eXBlOiBnbGFzc1R5cGUsXG4gICAgICAgICAgb3RyX3ByaWNlOiBvdHJWYWx1ZVxuICAgICAgICB9KVxuICAgICAgICAuZXEoJ3F1b3RlX2lkJywgcXVvdGVJZClcbiAgICAgICAgLnNlbGVjdCgpO1xuXG4gICAgICBpZiAodXBkYXRlRXJyb3IgfHwgIXVwZGF0ZURhdGEgfHwgdXBkYXRlRGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1VwZGF0ZSBmYWlsZWQgb3Igbm8gcmVjb3JkIGZvdW5kLCBhdHRlbXB0aW5nIHVwc2VydC4uLicpO1xuICAgICAgICBcbiAgICAgICAgLy8gSWYgdXBkYXRlIGZhaWxzIG9yIG5vIHJlY29yZCBleGlzdHMsIGNyZWF0ZSBhIG5ldyByZWNvcmRcbiAgICAgICAgY29uc3QgeyBkYXRhOiBpbnNlcnREYXRhLCBlcnJvcjogaW5zZXJ0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgLmZyb20oJ01hc3RlckN1c3RvbWVyJylcbiAgICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICAgIHF1b3RlX2lkOiBxdW90ZUlkLFxuICAgICAgICAgICAgcXVvdGVfcHJpY2U6IHRvdGFsUHJpY2UsXG4gICAgICAgICAgICBzZXJ2aWNlX3R5cGU6IGRlbGl2ZXJ5VHlwZSxcbiAgICAgICAgICAgIGdsYXNzX3R5cGU6IGdsYXNzVHlwZSxcbiAgICAgICAgICAgIG90cl9wcmljZTogb3RyVmFsdWUsXG4gICAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5zZWxlY3QoKTtcblxuICAgICAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdTdXBhYmFzZSBpbnNlcnQgZXJyb3I6JywgaW5zZXJ0RXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgY3JlYXRlZCBuZXcgcXVvdGUgcmVjb3JkIHdpdGggcHJpY2U6JywgdG90YWxQcmljZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgdXBkYXRlZCBxdW90ZSBwcmljZSBpbiBTdXBhYmFzZTonLCB0b3RhbFByaWNlKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChzdXBhYmFzZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTdXBhYmFzZSBlcnJvcjonLCBzdXBhYmFzZUVycm9yKTtcbiAgICAgIC8vIENvbnRpbnVlIGV4ZWN1dGlvbiBldmVuIGlmIFN1cGFiYXNlIG9wZXJhdGlvbiBmYWlsc1xuICAgIH1cblxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgcHJpY2U6IHRvdGFsUHJpY2UsXG4gICAgICBxdW90ZUlkLFxuICAgICAgYnJlYWtkb3duOiB7XG4gICAgICAgIC4uLmJyZWFrZG93bixcbiAgICAgICAgLy8gQWRkIGRldGFpbGVkIGJyZWFrZG93biBmb3IgZnJvbnRlbmQgZGlzcGxheVxuICAgICAgICBsYWJvdXJDb3N0OiBsYWJvdXJDb3N0LFxuICAgICAgICBtYXRlcmlhbHNDb3N0OiBNYXRoLnJvdW5kKG1hdGVyaWFsc0Nvc3QgKiAxMDApIC8gMTAwLFxuICAgICAgICBzdWJ0b3RhbDogTWF0aC5yb3VuZChzdWJ0b3RhbCAqIDEwMCkgLyAxMDAsXG4gICAgICAgIHNlcnZpY2VGZWU6IE1hdGgucm91bmQoc2VydmljZUZlZSAqIDEwMCkgLyAxMDAsXG4gICAgICAgIHRvdGFsQmVmb3JlVkFUOiBNYXRoLnJvdW5kKHRvdGFsQmVmb3JlVkFUICogMTAwKSAvIDEwMCxcbiAgICAgICAgdmF0OiBNYXRoLnJvdW5kKHZhdCAqIDEwMCkgLyAxMDAsXG4gICAgICAgIGZpbmFsUHJpY2U6IHRvdGFsUHJpY2UsXG4gICAgICAgIGdsYXNzVHlwZTogZ2xhc3NUeXBlLFxuICAgICAgICBkZWxpdmVyeVR5cGU6IGRlbGl2ZXJ5VHlwZVxuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIHF1b3RlOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiAnRmFpbGVkIHRvIGNhbGN1bGF0ZSBxdW90ZScgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJzdXBhYmFzZSIsImZldGNoVmVoaWNsZVZhbHVhdGlvbiIsInJlZ2lzdHJhdGlvbiIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJVS19WRUhJQ0xFX0RBVEFfQVBJX0tFWSIsImNvbnNvbGUiLCJlcnJvciIsImxvZyIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiZGF0YSIsImpzb24iLCJKU09OIiwic3RyaW5naWZ5IiwiUmVzcG9uc2UiLCJTdGF0dXNDb2RlIiwiZGF0YUl0ZW1zIiwiRGF0YUl0ZW1zIiwiVmFsdWF0aW9uTGlzdCIsIm90clZhbHVlIiwiT1RSIiwicGFyc2VGbG9hdCIsIk9iamVjdCIsImtleXMiLCJTdGF0dXNNZXNzYWdlIiwiY2FsY3VsYXRlTWF0ZXJpYWxzQ29zdCIsIm90clByaWNlIiwic2VsZWN0ZWRXaW5kb3dzIiwiZ2xhc3NDb2xvciIsImlzTmFOIiwid2luZG93T1RSUGVyY2VudGFnZXMiLCJ0b3RhbE1hdGVyaWFsc0Nvc3QiLCJBcnJheSIsImlzQXJyYXkiLCJ3aW5kb3dJZCIsInBlcmNlbnRhZ2UiLCJ3aW5kb3dDb3N0IiwicHJpdmFjeUNvc3QiLCJwcml2YWN5Tm90ZSIsInRvRml4ZWQiLCJmaW5hbENvc3QiLCJNYXRoIiwibWF4Iiwicm91bmQiLCJHTEFTU19QUklDSU5HIiwid2luZG93cyIsIm11bHRpcGxpZXIiLCJuYW1lIiwic3BlY2lmaWNhdGlvbnMiLCJnbGFzc1R5cGVzIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInN0YXR1cyIsIm1lc3NhZ2UiLCJ2ZWhpY2xlRGV0YWlscyIsIndpbmRvd1NwZWNpZmljYXRpb25zIiwid2luZG93RGFtYWdlIiwiZGVsaXZlcnlUeXBlIiwiZ2xhc3NUeXBlIiwiYm9keSIsInF1b3RlSWQiLCJEYXRlIiwibm93IiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJ0b1VwcGVyQ2FzZSIsImxhYm91ckNvc3QiLCJtYXRlcmlhbHNDb3N0Iiwic3BlY2lmaWNhdGlvbnNDb3N0IiwicmVkdWNlIiwidG90YWwiLCJzcGVjIiwic3BlY0Nvc3QiLCJnbGFzc011bHRpcGxpZXIiLCJzdWJ0b3RhbCIsInNlcnZpY2VGZWUiLCJ0b3RhbEJlZm9yZVZBVCIsInZhdCIsInRvdGFsUHJpY2UiLCJicmVha2Rvd24iLCJ3aW5kb3dDb3N0cyIsInNwZWNpZmljYXRpb25Db3N0cyIsImdsYXNzVHlwZU11bHRpcGxpZXIiLCJiYXNlVG90YWwiLCJ2ZWhpY2xlQmFzZWRQcmljZSIsImZpbmFsUHJpY2UiLCJ1cGRhdGVEYXRhIiwidXBkYXRlRXJyb3IiLCJmcm9tIiwidXBkYXRlIiwicXVvdGVfcHJpY2UiLCJzZXJ2aWNlX3R5cGUiLCJnbGFzc190eXBlIiwib3RyX3ByaWNlIiwiZXEiLCJzZWxlY3QiLCJsZW5ndGgiLCJpbnNlcnREYXRhIiwiaW5zZXJ0RXJyb3IiLCJpbnNlcnQiLCJxdW90ZV9pZCIsImNyZWF0ZWRfYXQiLCJ0b0lTT1N0cmluZyIsInVwZGF0ZWRfYXQiLCJzdXBhYmFzZUVycm9yIiwic3VjY2VzcyIsInByaWNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/calculate-quote.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcalculate-quote&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fcalculate-quote.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();